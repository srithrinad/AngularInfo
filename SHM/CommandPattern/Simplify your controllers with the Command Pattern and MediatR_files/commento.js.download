!function(A,l){"use strict";var t,i,s="commento",d="commento-main-area",u="commento-login",h="commento-login-box-container",x="commento-login-box",b="commento-login-box-email-subtitle",y="commento-login-box-email-input",w="commento-login-box-password-input",k="commento-login-box-name-input",T="commento-login-box-website-input",H="commento-login-box-email-button",C="commento-login-box-login-link-container",S="commento-login-box-login-link",L="commento-login-box-hr",B="commento-login-box-oauth-pretext",M="commento-login-box-oauth-buttons-container",p="commento-mod-tools",v="commento-mod-tools-lock-button",f="commento-error",a="commento-logged-container",g="commento-comments-area",N="commento-textarea-super-container-",E="commento-textarea-container-",D="commento-textarea-",R="commento-anonymous-checkbox-",O="commento-comment-card-",I="commento-comment-body-",U="commento-comment-text-",P="commento-comment-subtitle-",j="commento-comment-timeago-",q="commento-comment-score-",W="commento-comment-options-",J="commento-comment-edit-",Y="commento-comment-reply-",F="commento-comment-collapse-",V="commento-comment-upvote-",X="commento-comment-downvote-",_="commento-comment-approve-",z="commento-comment-remove-",G="commento-comment-sticky-",$="commento-comment-children-",K="commento-comment-contents-",Q="commento-comment-name-",Z="commento-submit-button-",ee="https://commento.io",oe="https://cdn.commento.io",ne=null,te=!1,ie=[],me={},re=!0,ae=!1,ce=!1,le=!1,se=!1,de="none",ue={},pe=[],ve="login",fe=!1,ge=void 0,he=null;function xe(e){return l.getElementById(e)}function be(e,o){e.prepend(o)}function ye(e,o){e.appendChild(o)}function we(e,o){e.parentNode.insertBefore(o,e.nextSibling)}function ke(e,o){e.classList.add("commento-"+o)}function Te(e,o){null!==e&&e.classList.remove("commento-"+o)}function He(e){return l.createElement(e)}function Ce(e){null!==e&&e.parentNode.removeChild(e)}function m(e,o){var n=e.attributes[o];if(void 0!==n)return n.value}function r(e){if(null!==e){var o=e.cloneNode(!0);if(null!==e.parentNode)return e.parentNode.replaceChild(o,e),o}return e}function Se(e,o,n){e.addEventListener("click",function(){o(n)},!1)}function Le(e,o,n){e.setAttribute(o,n)}function Be(e,o,n){var t=new XMLHttpRequest;t.open("POST",e,!0),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.onload=function(){n(JSON.parse(t.response))},t.send(JSON.stringify(o))}function Me(e){"function"==typeof e&&e()}function c(e,o){var n,t=new Date;t.setTime(t.getTime()+31536e6),n="; expires="+t.toUTCString(),l.cookie=e+"="+o+n+"; path=/"}function Ne(){var e=function(e){var o=("; "+l.cookie).split("; "+e+"=");if(2===o.length)return o.pop().split(";").shift()}("commentoCommenterToken");return void 0===e?"anonymous":e}function Ee(e){me[e.commenterHex]=e,ge=e.commenterHex;var o,n=He("div"),t=He("div"),i=He("a"),m=He("div"),r=Ue(e.commenterHex+"-"+e.name);n.id=a,ke(n,"logged-container"),ke(t,"logged-in-as"),ke(i,"name"),ke(m,"logout"),i.innerText=e.name,m.innerText="Logout",Se(m,A.logout),Le(n,"style","display: none"),Le(i,"href",e.link),"undefined"===e.photo?((o=He("div")).style.background=r,o.innerHTML=e.name[0].toUpperCase(),ke(o,"avatar")):(Le(o=He("img"),"src",oe+"/api/commenter/photo?commenterHex="+e.commenterHex),ke(o,"avatar-img")),ye(t,o),ye(t,i),ye(n,t),ye(n,m),be(ne,n),te=!0}function Ae(o){if("anonymous"===Ne())return te=!1,void Me(o);var e={commenterToken:Ne()};Be(ee+"/api/commenter/self",e,function(e){if(!e.success)return c("commentoCommenterToken","anonymous"),void Me(o);Ee(e.commenter),Me(o)})}function De(e,o){var n=He("link"),t=l.getElementsByTagName("head")[0];n.type="text/css",Le(n,"href",e),Le(n,"rel","stylesheet"),Le(n,"onload",o),ye(t,n)}function Re(e){var o=xe(f);o.innerText=e,Le(o,"style","display: block;")}function Oe(e){var o,n=He("div"),t=He("div"),i=He("textarea"),m=He("div"),r=He("input"),a=He("label"),c=He("button");return n.id=N+e,t.id=E+e,i.id=D+e,r.id=R+e,c.id=Z+e,ke(t,"textarea-container"),ke(m,"round-check"),ke(m,"anonymous-checkbox-container"),ke(c,"button"),ke(c,"submit-button"),ke(n,"button-margin"),Le(i,"placeholder","Add a comment"),Le(r,"type","checkbox"),Le(a,"for",R+e),a.innerText="Comment anonymously",c.innerText="Add Comment",i.oninput=(o=i,function(){o.style.height="",o.style.height=Math.min(Math.max(o.scrollHeight,75),400)+"px"}),Se(c,Je,e),ye(t,i),ye(n,t),ye(m,r),ye(m,a),ye(n,c),re||ye(n,m),n}function Ie(e){var o=He("div");return ke(o,"moderation-notice"),o.innerText=e,o}function Ue(e){for(var o=["#396ab1","#da7c30","#3e9651","#cc2529","#535154","#6b4c9a","#922428"],n=0,t=0;t<e.length;t++)n+=e.charCodeAt(t);return o[n%o.length]}function Pe(e){return 1!==e?e+" points":e+" point"}function je(M,N){var e=M[N];if(!e||!e.length)return null;e.sort(function(e,o){return e.commentHex===de?-1/0:o.commentHex===de?1/0:o.score-e.score});var E=He("div");return e.forEach(function(e){var o,n,t=me[e.commenterHex],i=He("div"),m=He("div"),r=He("div"),a=He("div"),c=He("div"),l=He("div"),s=He("div"),d=He("div"),u=He("button"),p=He("button"),v=He("button"),f=He("button"),g=He("button"),h=He("button"),x=He("button"),b=He("button"),y=je(M,e.commentHex),w=He("div"),k=Ue(e.commenterHex+"-"+t.name);n="undefined"!==t.link&&"https://undefined"!==t.link&&""!==t.link?He("a"):He("div");var T,H,C=new Date(e.creationDate);if(i.id=O+e.commentHex,l.id=I+e.commentHex,s.id=U+e.commentHex,r.id=P+e.commentHex,a.id=j+e.commentHex,c.id=q+e.commentHex,d.id=W+e.commentHex,u.id=J+e.commentHex,p.id=Y+e.commentHex,v.id=F+e.commentHex,f.id=V+e.commentHex,g.id=X+e.commentHex,h.id=_+e.commentHex,x.id=z+e.commentHex,b.id=G+e.commentHex,y&&(y.id=$+e.commentHex),w.id=K+e.commentHex,n.id=Q+e.commentHex,v.title="Collapse children",f.title="Upvote",g.title="Downvote",u.title="Edit",p.title="Reply",h.title="Approve",x.title="Remove",de===e.commentHex?b.title=ae?"Unsticky":"This comment has been stickied":b.title="Sticky",a.title=C.toString(),i.style.borderLeft="2px solid "+k,n.innerText=t.name,s.innerHTML=e.html,a.innerHTML=(T=(new Date).getTime(),(H=T-C)<5e3?"just now":H<6e4?Math.round(H/1e3)+" seconds ago":H<36e5?Math.round(H/6e4)+" minutes ago":H<864e5?Math.round(H/36e5)+" hours ago":H<2592e6?Math.round(H/864e5)+" days ago":H<94608e7?Math.round(H/2592e6)+" months ago":Math.round(H/94608e7)+" years ago"),c.innerText=Pe(e.score),"undefined"===t.photo?((o=He("div")).style.background=k,o.innerHTML=t.name[0].toUpperCase(),ke(o,"avatar")):(Le(o=He("img"),"src",oe+"/api/commenter/photo?commenterHex="+t.commenterHex),ke(o,"avatar-img")),ke(i,"card"),ae&&"approved"!==e.state&&ke(i,"dark-card"),t.isModerator&&ke(n,"moderator"),"flagged"===e.state&&ke(n,"flagged"),ke(m,"header"),ke(n,"name"),ke(r,"subtitle"),ke(a,"timeago"),ke(c,"score"),ke(l,"body"),ke(d,"options"),he&&ke(d,"options-mobile"),ke(u,"option-button"),ke(u,"option-edit"),ke(p,"option-button"),ke(p,"option-reply"),ke(v,"option-button"),ke(v,"option-collapse"),ke(f,"option-button"),ke(f,"option-upvote"),ke(g,"option-button"),ke(g,"option-downvote"),ke(h,"option-button"),ke(h,"option-approve"),ke(x,"option-button"),ke(x,"option-remove"),ke(b,"option-button"),de===e.commentHex?ke(b,"option-unsticky"):ke(b,"option-sticky"),te&&(0<e.direction?ke(f,"upvoted"):e.direction<0&&ke(g,"downvoted")),Se(v,A.commentCollapse,e.commentHex),Se(h,A.commentApprove,e.commentHex),Se(x,A.commentDelete,e.commentHex),Se(b,A.commentSticky,e.commentHex),te){var S=qe(f,g,e.commentHex,e.direction);f=S[0],g=S[1]}else Se(f,A.loginBoxShow,null),Se(g,A.loginBoxShow,null);Se(p,A.replyShow,e.commentHex),"undefined"!==t.link&&"https://undefined"!==t.link&&""!==t.link&&Le(n,"href",t.link),ye(d,v),ye(d,g),ye(d,f),se||ye(d,p),ae?("root"===N&&ye(d,b),ye(d,x),"approved"!==e.state&&ye(d,h)):de===e.commentHex&&ye(d,b),Le(d,"style","width: "+32*(d.childNodes.length+1)+"px;");for(var L=0;L<d.childNodes.length;L++)Le(d.childNodes[L],"style","right: "+32*L+"px;");if(ye(r,c),ye(r,a),he||ye(m,d),ye(m,o),ye(m,n),ye(m,r),ye(l,s),ye(w,l),he){ye(w,d);var B=He("div");ke(B,"options-clearfix"),ye(w,B)}y&&(ke(y,"body"),ye(w,y)),ye(i,m),ye(i,w),ye(E,i)}),E}function qe(e,o,n,t){return e=r(e),o=r(o),0<t?(Se(e,A.vote,[n,[1,0]]),Se(o,A.vote,[n,[1,-1]])):t<0?(Se(e,A.vote,[n,[-1,1]]),Se(o,A.vote,[n,[-1,0]])):(Se(e,A.vote,[n,[0,1]]),Se(o,A.vote,[n,[0,-1]])),[e,o]}function We(e){te?A.commentNew(e,Ne()):A.loginBoxShow(e)}function Je(e){if(re)We(e);else{var o,n=xe(R+e),t=xe(D+e);if(""!==t.value)return Te(t,"red-border"),n.checked?(o=e,le=!0,void A.commentNew(o,"anonymous")):void We(e);else ke(t,"red-border")}}function o(e){xe(s).innerHTML="",ue={},A.main(e)}function Ye(e,o,n){Be(ee+"/api/commenter/login",{email:e,password:o},function(e){if(!e.success)return A.loginBoxClose(),void Re(e.message);c("commentoCommenterToken",e.commenterToken),Ee(e.commenter);var o=xe(a);o&&Le(o,"style",""),Ce(xe(u)),null!==n?A.commentNew(n,e.commenterToken,function(){A.loginBoxClose()}):A.loginBoxClose()})}function n(o){var e={isLocked:se,stickyCommentHex:de},n={commenterToken:Ne(),domain:parent.location.host,path:parent.location.pathname,attributes:e};Be(ee+"/api/page/update",n,function(e){e.success?Me(o):Re(e.message)})}function e(){for(var e,o=(e="script",l.getElementsByTagName(e)),n=0;n<o.length;n++)o[n].src.match(/\/js\/commento\.js$/)&&(t=m(o[n],"data-css-override"),i=m(o[n],"data-auto-init"),void 0===(s=m(o[n],"data-id-root"))&&(s="commento"))}A.logout=function(){c("commentoCommenterToken","anonymous"),o()},A.commentNew=function(i,m,r){var a=xe(N+i),c=xe(D+i),l=xe(Y+i),s=c.value;if(""!==s){Te(c,"red-border");var e={commenterToken:m,domain:parent.location.host,path:parent.location.pathname,parentHex:i,markdown:s};Be(ee+"/api/comment/new",e,function(e){if(e.success){var o="";"unapproved"===e.state?o="Your comment is under moderation.":"flagged"===e.state&&(o="Your comment was flagged as spam and is under moderation."),""!==o&&be(xe(N+i),Ie(o));var n=ge;void 0!==n&&"anonymous"!==m||(n="anonymous");var t=je({root:[{commentHex:e.commentHex,commenterHex:n,markdown:s,html:e.html,parentHex:"root",score:0,state:"approved",direction:0,creationDate:(new Date).toISOString()}]},"root");"root"!==i?(a.replaceWith(t),ue[i]=!1,ke(l,"option-reply"),Te(l,"option-cancel"),l.title="Reply to this comment",Se(l,A.replyShow,i)):(c.value="",we(a,t)),Me(r)}else Re(e.message)})}else ke(c,"red-border")},A.commentApprove=function(i){var e={commenterToken:Ne(),commentHex:i};Be(ee+"/api/comment/approve",e,function(e){if(e.success){var o=xe(O+i),n=xe(Q+i),t=xe(_+i);Te(o,"dark-card"),Te(n,"flagged"),Ce(t)}else Re(e.message)})},A.commentDelete=function(o){var e={commenterToken:Ne(),commentHex:o};Be(ee+"/api/comment/delete",e,function(e){e.success?Ce(xe(O+o)):Re(e.message)})},A.vote=function(e){var o=e[0],n=e[1][0],t=e[1][1],i=xe(V+o),m=xe(X+o),r=xe(q+o),a={commenterToken:Ne(),commentHex:o,direction:t},c=qe(i,m,o,t);i=c[0],m=c[1],Te(i,"upvoted"),Te(m,"downvoted"),0<t?ke(i,"upvoted"):t<0&&ke(m,"downvoted"),r.innerText=Pe(parseInt(r.innerText.replace(/[^\d-.]/g,""))+t-n),Be(ee+"/api/comment/vote",a,function(e){if(!e.success)return Re(e.message),Te(i,"upvoted"),Te(m,"downvoted"),r.innerText=Pe(parseInt(r.innerText.replace(/[^\d-.]/g,""))-t+n),void qe(i,m,o,n)})},A.replyShow=function(e){if(!(e in ue&&ue[e])){we(xe(U+e),Oe(e)),ue[e]=!0;var o=xe(Y+e);Te(o,"option-reply"),ke(o,"option-cancel"),o.title="Cancel reply",Se(o,A.replyCollapse,e)}},A.replyCollapse=function(e){var o=xe(Y+e);xe(N+e).remove(),ue[e]=!1,ke(o,"option-reply"),Te(o,"option-cancel"),o.title="Reply to this comment",Se(o,A.replyShow,e)},A.commentCollapse=function(e){var o=xe($+e),n=xe(F+e);o&&ke(o,"hidden"),Te(n,"option-collapse"),ke(n,"option-uncollapse"),n.title="Expand children",Se(n,A.commentUncollapse,e)},A.commentUncollapse=function(e){var o=xe($+e),n=xe(F+e);o&&Te(o,"hidden"),Te(n,"option-uncollapse"),ke(n,"option-collapse"),n.title="Collapse children",Se(n,A.commentCollapse,e)},A.commentoAuth=function(e){var o,n,t,i=e.provider,m=e.id,r=window.open("","_blank");o=ee+"/api/commenter/token/new",n=function(o){if(o.success){c("commentoCommenterToken",o.commenterToken),r.location=ee+"/api/oauth/"+i+"/redirect?commenterToken="+o.commenterToken;var e=setInterval(function(){r.closed&&(clearInterval(e),Ae(function(){var e=xe(a);e&&Le(e,"style",""),Ce(xe(u)),null!==m?A.commentNew(m,o.commenterToken,function(){A.loginBoxClose()}):A.loginBoxClose()}))},250)}else Re(o.message)},(t=new XMLHttpRequest).open("GET",o,!0),t.onload=function(){n(JSON.parse(t.response))},t.send(null)},A.popupRender=function(e){var o=xe(h),n=He("div"),t=He("div"),i=He("div"),m=He("div"),r=He("hr"),a=He("div"),c=He("div"),l=He("div"),s=He("input"),d=He("button"),u=He("div"),p=He("a"),v=He("div");n.id=x,a.id=b,s.id=y,d.id=H,p.id=S,u.id=C,r.id=L,t.id=B,i.id=M,ke(o,"login-box-container"),ke(n,"login-box"),ke(a,"login-box-subtitle"),ke(c,"email-container"),ke(l,"email"),ke(s,"input"),ke(d,"email-button"),ke(u,"login-link-container"),ke(p,"login-link"),ke(t,"login-box-subtitle"),ke(i,"oauth-buttons-container"),ke(m,"oauth-buttons"),ke(v,"login-box-close"),ke(ne,"root-min-height"),p.innerText="Don't have an account? Sign up.",a.innerText="Login with your email address",d.innerText="Continue",t.innerText="Proceed with social login",Se(d,A.passwordAsk,e),Se(p,A.popupSwitch),Se(v,A.loginBoxClose),Le(o,"style","display: none; opacity: 0;"),Le(s,"name","email"),Le(s,"placeholder","Email address"),Le(s,"type","text");for(var f=0;f<pe.length;f++){var g=He("button");ke(g,"button"),ke(g,pe[f]+"-button"),g.innerText=pe[f],Se(g,A.commentoAuth,{provider:pe[f],id:e}),ye(m,g)}fe=0<pe.length&&(ye(n,t),ye(i,m),ye(n,i),ye(n,r),!0),ye(n,a),ye(l,s),ye(l,d),ye(c,l),ye(n,c),ye(u,p),ye(n,u),ye(n,v),ve="login",o.innerHTML="",ye(o,n)},A.popupSwitch=function(){var e=xe(b),o=xe(S);ve="login"===ve?(o.innerText="Already have an account? Log in.",e.innerText="Create an account","signup"):(o.innerText="Don't have an account? Sign up.",e.innerText="Login with your email address","login")},A.login=function(e){var o=xe(y),n=xe(w);Ye(o.value,n.value,e)},A.signup=function(o){var n=xe(y),e=xe(k),t=xe(T),i=xe(w),m={email:n.value,name:e.value,website:t.value,password:i.value};Be(ee+"/api/commenter/new",m,function(e){if(!e.success)return A.loginBoxClose(),void Re(e.message);Ye(n.value,i.value,o)})},A.passwordAsk=function(e){var o,n,t,i,m=xe(x),r=xe(b),a=xe(H),c=xe(C),l=xe(L),s=xe(M),d=xe(B);Ce(a),Ce(c),fe&&0<pe.length&&(Ce(l),Ce(d),Ce(s)),i="signup"===ve?(o=["name","website","password"],n=[k,T,w],t=["text","text","password"],["Real Name","Website (Optional)","Password"]):(o=["password"],n=[w],t=["password"],["Password"]),r.innerText="signup"===ve?"Finish the rest of your profile to complete.":"Enter your password to log in.";for(var u=0;u<o.length;u++){var p=He("div"),v=He("div"),f=He("input");if(f.id=n[u],ke(p,"email-container"),ke(v,"email"),ke(f,"input"),Le(f,"name",o[u]),Le(f,"type",t[u]),Le(f,"placeholder",i[u]),ye(v,f),ye(p,v),"password"===o[u]){var g=He("button");ke(g,"email-button"),g.innerText=ve,Se(g,"signup"===ve?A.signup:A.login,e),ye(v,g)}ye(m,p)}"signup"===ve?xe(k).focus():xe(w).focus()},A.threadLockToggle=function(){var e=xe(v);se=!se,e.disabled=!0,n(function(){e.disabled=!1,o()})},A.commentSticky=function(o){if("none"!==de){var e=xe(G+de);null===e?de="none":(Te(e,"option-unsticky"),ke(e,"option-sticky"))}de=de===o?"none":o,n(function(){var e=xe(G+o);de===o?(Te(e,"option-sticky"),ke(e,"option-unsticky")):(Te(e,"option-unsticky"),ke(e,"option-sticky"))})},A.loadCssOverride=function(){void 0===t?A.allShow():De(t,"window.commento.allShow()")},A.allShow=function(){var e=xe(d),o=xe(p),n=xe(a);Le(e,"style",""),ae&&Le(o,"style",""),n&&Le(n,"style","")},A.loginBoxClose=function(){var e=xe(d),o=xe(h);Te(e,"blurred"),Te(ne,"root-min-height"),Le(o,"style","display: none")},A.loginBoxShow=function(e){var o=xe(d),n=xe(h);A.popupRender(e),ke(o,"blurred"),Le(n,"style",""),window.location.hash=h,xe(y).focus()};var Fe=!(A.main=function(a){if(null!==(ne=xe(s))){var e,o,n;null===he&&(he=ne.getBoundingClientRect().width<450),ke(ne,"root"),(e=He("div")).id=h,ye(ne,e),(o=He("div")).id=f,ke(o,"error-box"),Le(o,"style","display: none;"),ye(ne,o),(n=He("div")).id=d,ke(n,"main-area"),Le(n,"style","display: none"),ye(ne,n);var t,i,m,r,c=(t=He("div"),i=He("div"),m=He("a"),r=He("span"),t.id="commento-footer",ke(t,"footer"),ke(i,"logo-container"),ke(m,"logo"),ke(r,"logo-text"),Le(m,"href","https://commento.io"),Le(m,"target","_blank"),r.innerText="Commento",ye(m,r),ye(i,m),ye(t,i),t);De(oe+"/css/commento.css","window.commento.loadCssOverride()"),Ae(function(){var o,e;o=function(){var e,o,n,t,i,m,r;e=He("div"),o=He("button"),e.id=p,o.id=v,ke(e,"mod-tools"),o.innerHTML=se?"Unlock Thread":"Lock Thread",Se(o,A.threadLockToggle),Le(e,"style","display: none"),ye(e,o),ye(ne,e),n=function(){!function(){var o,n={},e=xe(g);ie.forEach(function(e){(o=e.parentHex)in n||(n[o]=[]),n[o].push(e)});var t=je(n,"root");t&&ye(e,t)}(),ye(ne,c),Le(ne,"style",""),function(){for(var e=l.getElementsByClassName("commento-name"),o=0;o<e.length;o++)Le(e[o],"style","max-width: "+(e[o].getBoundingClientRect().width+20)+"px;")}(),function(){if(window.location.hash)if(window.location.hash.startsWith("#commento-")){var e=xe(O+window.location.hash.split("-")[1]);if(null===e)return;ke(e,"highlighted-card"),e.scrollIntoView(!0)}else window.location.hash.startsWith("#commento")&&ne.scrollIntoView(!0)}(),Me(a)},t=He("div"),i=He("div"),m=xe(d),r=He("div"),t.id=u,r.id=g,ke(t,"login"),ke(i,"login-text"),ke(r,"comments"),i.innerText="Login",r.innerHTML="",Se(i,A.loginBoxShow,null),ye(t,i),se||ce?te||le?(ye(m,Ie("This thread is locked. You cannot add new comments.")),Ce(xe(u))):(ye(m,t),ye(m,Oe("root"))):(te?Ce(xe(u)):ye(m,t),ye(m,Oe("root"))),ye(m,r),ye(ne,m),Me(n)},e={commenterToken:Ne(),domain:parent.location.host,path:parent.location.pathname},Be(ee+"/api/comment/list",e,function(e){e.success?(re=e.requireIdentification,ae=e.isModerator,ce=e.isFrozen,se=e.attributes.isLocked,de=e.attributes.stickyCommentHex,ie=e.comments,me=Object.assign({},me,e.commenters),pe=e.configuredOauths,Me(o)):Re(e.message)})})}else console.log("[commento] error: no root element with ID '"+s+"' found")});function Ve(){Fe||(Fe=!0,e(),"true"===i||void 0===i?A.main(void 0):"false"!==i&&console.log("[commento] error: invalid value for data-auto-init; allowed values: true, false"))}var Xe=function(){var e=l.readyState;"loading"===e?l.addEventListener("readystatechange",Xe):"interactive"===e?Ve():"complete"===e&&Ve()};Xe()}(window.commento,document);